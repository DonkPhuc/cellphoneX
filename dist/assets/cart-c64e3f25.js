import{d as j,g as T,K as $,s as q,u as H,h as S,m as D,v as E,n as b,o as r,c as u,i as l,a as t,b as c,L as y,F,e as B,t as f,J as I,k as L,Q as w}from"./index-5ef231b5.js";const Q={class:"flex"},z=t("div",{class:"hidden flex-1 lg:flex"},null,-1),G={key:0,class:"flex flex-1 flex-col py-4"},K={class:"flex flex-1 flex-col gap-12"},M={class:"flex"},J=t("span",{class:"flex flex-1 justify-center text-xl font-bold text-main"},[t("p",{class:"-ml-16"},"Giỏ hàng")],-1),U={class:"flex justify-center pt-20"},A=t("div",{class:"flex justify-center"},[t("p",{class:"text-xl"},"Không có sản phẩm nào trong giỏ hàng, vui lòng quay lại")],-1),O={class:"flex justify-center"},W={key:1,class:"flex flex-1 flex-col py-4"},X={class:"flex flex-1 flex-col gap-12"},Y={class:"flex"},Z=t("span",{class:"flex flex-1 justify-center text-xl font-bold text-main"},[t("p",{class:"-ml-16"},"Giỏ hàng")],-1),tt={class:"flex gap-8 border-b-2 p-4"},et=["src"],st={class:"flex flex-1 flex-col gap-2"},ot={class:"flex justify-between"},nt=["onClick"],lt=["onClick"],ct={class:"flex justify-between"},at={class:"font-bold text-main"},it={class:"text-xs text-gray-500 line-through"},rt={class:"flex items-center rounded-xl border bg-[#f4f4f4]"},ut=["onClick"],ft={class:"px-3 text-xs"},dt=["onClick"],_t={class:"flex flex-col justify-center gap-4 rounded-lg border p-2 shadow-lg"},pt={class:"flex flex-1 justify-between"},xt=t("span",{class:"font-bold"},"Tổng tiền tạm tính:",-1),ht={class:"font-bold text-main"},vt=t("div",{class:"hidden flex-1 lg:flex"},null,-1),mt=j({__name:"cart",setup(yt){const p=T(),k=$(),{isLoginSuccess:d}=q(p),x=H(),o=S([]);D(()=>{d.value===""&&_()}),E(async()=>{const s=await p.getCustomer(d.value);s[0]&&(o.value=s[0].cart,o.value.forEach(e=>{e.price=e.priceRRP-e.priceRRP*(e.discount/100)})),window.scrollTo(0,0)});async function _(){await x.push("/")}async function C(){await x.push("/payment")}const g=b(()=>s=>{let e={price:"",priceRRP:""};return e.price=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s.price*s.quantity),e.priceRRP=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s.priceRRP*s.quantity),e}),N=b(()=>{let s=0;return o.value.forEach(e=>{s+=Number(e.price*e.quantity)}),new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s)});function R(s){o.value[s].quantity++,console.log(o.value)}function V(s){o.value[s].quantity>1&&o.value[s].quantity--}async function P(s){await k.postRemoveCart(d.value,s);const e=await p.getCustomer(d.value);e[0]&&(o.value=e[0].cart,o.value.forEach(n=>{n.price=n.priceRRP-n.priceRRP*(n.discount/100)}))}async function h(s){let e=o.value.find(({_id:n})=>n===s);s==="/"?await _():e&&await x.push(`products/${e._id}`)}return(s,e)=>{const n=I,v=L;return r(),u("main",Q,[z,l(o)[0]&&!l(o)[0]._id?(r(),u("div",G,[t("div",K,[t("div",M,[t("span",{class:"flex cursor-pointer items-start font-bold text-main",onClick:e[0]||(e[0]=a=>h("/"))},[c(n,{size:"text-[20px]",icon:"fa-angle-left"}),y(" Trở về ")]),J]),t("div",U,[c(n,{size:"text-[80px]",icon:"fa-smile-o"})]),A,t("div",O,[c(v,{"input-class":"!h-10 w-44 !bg-main border-none rounded-lg",label:"Quay lại trang chủ",onClick:_})])])])):(r(),u("div",W,[t("div",X,[t("div",Y,[t("span",{class:"flex cursor-pointer items-start font-bold text-main",onClick:e[1]||(e[1]=a=>h("/"))},[c(n,{size:"text-[20px]",icon:"fa-angle-left"}),y(" Trở về ")]),Z]),(r(!0),u(F,null,B(l(o),(a,i)=>(r(),u("div",{key:i,class:"flex max-h-[400px] flex-col overflow-y-auto"},[t("div",tt,[t("img",{class:"h-32 w-32",src:a.imageLink,alt:""},null,8,et),t("div",st,[t("div",ot,[t("p",{class:"cursor-pointer font-bold hover:underline",onClick:m=>h(a._id)},f(a.name),9,nt),t("div",{class:"cursor-pointer",onClick:m=>P(a._id)},[c(n,{icon:"fa-times"})],8,lt)]),t("div",ct,[t("p",at,[y(f(l(g)(l(o)[i]).price)+" ",1),t("span",it,f(l(g)(l(o)[i]).priceRRP),1)]),t("div",rt,[t("div",{class:"cursor-pointer",onClick:m=>V(i)},[c(n,{icon:"fa-minus"})],8,ut),t("p",ft,f(a.quantity),1),t("div",{class:"cursor-pointer",onClick:m=>R(i)},[c(n,{icon:"fa-plus"})],8,dt)])])])])]))),128)),t("div",_t,[t("div",pt,[xt,t("span",ht,f(l(N)),1)]),c(v,{class:"!text-white disabled:!bg-main/60",disabled:l(o).length===0,"input-class":"!h-16 w-full !bg-main border-none rounded text-[16px] !font-bold",label:"TIẾN HÀNH ĐẶT HÀNG",onClick:C},null,8,["disabled"]),c(v,{variant:"outlined","input-class":"!h-16 w-full !border-main !text-main rounded hover:!bg-main/70 hover:!text-white !text-[16px] !font-bold active:bg-main/70",label:"CHỌN THÊM SẢN PHẨM KHÁC",onClick:_})])])])),vt])}}});typeof w=="function"&&w(mt);export{mt as default};
